# Trivy Configuration File
#
# Este archivo permite configurar el comportamiento de Trivy para escaneos locales
# Para usar: trivy image --config trivy.yaml <image-name>
#
# Documentación: https://aquasecurity.github.io/trivy/latest/docs/configuration/

# Formato de salida (table, json, sarif, template)
format: table

# Niveles de severidad a reportar
severity:
  - CRITICAL
  - HIGH
  - MEDIUM

# Tipos de vulnerabilidades a escanear
vuln-type:
  - os          # Vulnerabilidades del OS
  - library     # Vulnerabilidades en librerías/dependencias

# Configuración de caché
cache:
  # Directorio de caché (por defecto: ~/.cache/trivy)
  # dir: /tmp/trivy-cache

# Timeout para el escaneo (en segundos)
timeout: 5m

# Ignorar vulnerabilidades sin fix disponible (opcional)
# ignore-unfixed: true

# Escanear solo archivos específicos
# skip-files:
#   - "**/*.md"
#   - "**/test/**"

# Directorios a omitir
# skip-dirs:
#   - node_modules
#   - vendor

# Base de datos de vulnerabilidades
db:
  # No usar base de datos ligera (usar completa para mayor precisión)
  no-progress: false
  # skip-update: false

# Configuración de salida
output:
  # Eliminar duplicados en el reporte
  # deduplicate: true

  # Mostrar solo vulnerabilidades con fix disponible
  # exit-on-eol: false

# Configuración para contenedores
# image:
#   # Remover imágenes descargadas después del escaneo
#   removed-pkgs: true
#
#   # Escanear archivos del sistema de archivos
#   scanners:
#     - vuln
#     - secret

# Configuración de secretos (para escaneo de secretos en imágenes)
# secret:
#   config: .secret-scan.yaml
